Processing data/GEMSGD_T5TokenizerFast_SGD_PaperNaiveLinearizer_train
Map: 100%|███████████████████████████| 164982/164982 [00:33<00:00, 4950.01 examples/s]
{'gem_id': ['schema_guided_dialog-train-0', 'schema_guided_dialog-train-1', 'schema_guided_dialog-train-2', 'schema_guided_dialog-train-3', 'schema_guided_dialog-train-4', 'schema_guided_dialog-train-5', 'schema_guided_dialog-train-6', 'schema_guided_dialog-train-7', 'schema_guided_dialog-train-8', 'schema_guided_dialog-train-9', 'schema_guided_dialog-train-10', 'schema_guided_dialog-train-11', 'schema_guided_dialog-train-12', 'schema_guided_dialog-train-13', 'schema_guided_dialog-train-14', 'schema_guided_dialog-train-15', 'schema_guided_dialog-train-16', 'schema_guided_dialog-train-17', 'schema_guided_dialog-train-18', 'schema_guided_dialog-train-19'], 'gem_parent_id': ['schema_guided_dialog-train-0', 'schema_guided_dialog-train-1', 'schema_guided_dialog-train-2', 'schema_guided_dialog-train-3', 'schema_guided_dialog-train-4', 'schema_guided_dialog-train-5', 'schema_guided_dialog-train-6', 'schema_guided_dialog-train-7', 'schema_guided_dialog-train-8', 'schema_guided_dialog-train-9', 'schema_guided_dialog-train-10', 'schema_guided_dialog-train-11', 'schema_guided_dialog-train-12', 'schema_guided_dialog-train-13', 'schema_guided_dialog-train-14', 'schema_guided_dialog-train-15', 'schema_guided_dialog-train-16', 'schema_guided_dialog-train-17', 'schema_guided_dialog-train-18', 'schema_guided_dialog-train-19'], 'dialog_acts': [[{'act': 13, 'slot': 'city', 'values': []}], [{'act': 13, 'slot': 'cuisine', 'values': ['Mexican', 'Italian']}], [{'act': 11, 'slot': 'restaurant_name', 'values': ['71 Saint Peter']}, {'act': 11, 'slot': 'city', 'values': ['San Jose']}], [{'act': 4, 'slot': 'street_address', 'values': ['71 North San Pedro Street']}], [{'act': 4, 'slot': 'phone_number', 'values': ['408-971-8523']}], [{'act': 11, 'slot': 'restaurant_name', 'values': ['Bazille']}, {'act': 11, 'slot': 'city', 'values': ['San Jose']}], [{'act': 11, 'slot': 'restaurant_name', 'values': ['Bird Dog']}, {'act': 11, 'slot': 'city', 'values': ['Palo Alto']}, {'act': 5, 'slot': 'count', 'values': ['7']}], [{'act': 13, 'slot': 'time', 'values': []}], [{'act': 2, 'slot': 'restaurant_name', 'values': ['Bird Dog']}, {'act': 2, 'slot': 'city', 'values': ['Palo Alto']}, {'act': 2, 'slot': 'time', 'values': ['11:30 am']}, {'act': 2, 'slot': 'party_size', 'values': ['2']}, {'act': 2, 'slot': 'date', 'values': ['today']}], [{'act': 4, 'slot': 'has_live_music', 'values': ['False']}, {'act': 10, 'slot': '', 'values': []}], [{'act': 4, 'slot': 'street_address', 'values': ['420 Ramona Street']}, {'act': 4, 'slot': 'serves_alcohol', 'values': ['False']}], [{'act': 3, 'slot': '', 'values': []}], [{'act': 13, 'slot': 'cuisine', 'values': []}, {'act': 13, 'slot': 'city', 'values': []}], [{'act': 11, 'slot': 'restaurant_name', 'values': ['Anjappar Chettinad Restaurant']}, {'act': 11, 'slot': 'city', 'values': ['Milpitas']}], [{'act': 4, 'slot': 'street_address', 'values': ['Milpitas Square']}, {'act': 4, 'slot': 'price_range', 'values': ['moderate']}], [{'act': 11, 'slot': 'restaurant_name', 'values': ['Aria Dining & Banquets Fine Indian Cuisine']}, {'act': 11, 'slot': 'city', 'values': ['Milpitas']}], [{'act': 11, 'slot': 'restaurant_name', 'values': ['Olive garden Italian Restaurant']}, {'act': 11, 'slot': 'city', 'values': ['Milpitas']}, {'act': 5, 'slot': 'count', 'values': ['2']}], [{'act': 12, 'slot': 'intent', 'values': ['ReserveRestaurant']}], [{'act': 13, 'slot': 'time', 'values': []}], [{'act': 2, 'slot': 'restaurant_name', 'values': ['Olive Garden Italian Restaurant']}, {'act': 2, 'slot': 'city', 'values': ['Milpitas']}, {'act': 2, 'slot': 'time', 'values': ['1:30 pm']}, {'act': 2, 'slot': 'date', 'values': ['March 11th']}, {'act': 2, 'slot': 'party_size', 'values': ['2']}]], 'context': [[], ['I am feeling hungry so I would like to find a place to eat.', 'Do you have a specific which you want the eating place to be located at?'], ['I am feeling hungry so I would like to find a place to eat.', 'Do you have a specific which you want the eating place to be located at?', 'I would like for it to be in San Jose.', 'Is there a specific cuisine type you enjoy
Map: 100%|███████████████████████████| 164982/164982 [00:34<00:00, 4736.04 examples/s]
Map: 100%|███████████████████████████| 164982/164982 [00:35<00:00, 4645.90 examples/s]
Map: 100%|███████████████████████████| 164982/164982 [00:45<00:00, 3615.53 examples/s]
Saving the dataset (3/3 shards): 100%|█| 164982/164982 [00:01<00:00, 147517.12 example
Processing data/GEMSGD_T5TokenizerFast_SGD_PaperNaiveLinearizer_val
Map: 100%|█████████████████████████████| 10000/10000 [00:01<00:00, 5021.91 examples/s]
{'gem_id': ['schema_guided_dialog-validation-0', 'schema_guided_dialog-validation-1', 'schema_guided_dialog-validation-2', 'schema_guided_dialog-validation-3', 'schema_guided_dialog-validation-4', 'schema_guided_dialog-validation-5', 'schema_guided_dialog-validation-6', 'schema_guided_dialog-validation-7', 'schema_guided_dialog-validation-8', 'schema_guided_dialog-validation-9', 'schema_guided_dialog-validation-10', 'schema_guided_dialog-validation-11', 'schema_guided_dialog-validation-12', 'schema_guided_dialog-validation-13', 'schema_guided_dialog-validation-14', 'schema_guided_dialog-validation-15', 'schema_guided_dialog-validation-16', 'schema_guided_dialog-validation-17', 'schema_guided_dialog-validation-18', 'schema_guided_dialog-validation-19'], 'gem_parent_id': ['schema_guided_dialog-validation-0', 'schema_guided_dialog-validation-1', 'schema_guided_dialog-validation-2', 'schema_guided_dialog-validation-3', 'schema_guided_dialog-validation-4', 'schema_guided_dialog-validation-5', 'schema_guided_dialog-validation-6', 'schema_guided_dialog-validation-7', 'schema_guided_dialog-validation-8', 'schema_guided_dialog-validation-9', 'schema_guided_dialog-validation-10', 'schema_guided_dialog-validation-11', 'schema_guided_dialog-validation-12', 'schema_guided_dialog-validation-13', 'schema_guided_dialog-validation-14', 'schema_guided_dialog-validation-15', 'schema_guided_dialog-validation-16', 'schema_guided_dialog-validation-17', 'schema_guided_dialog-validation-18', 'schema_guided_dialog-validation-19'], 'dialog_acts': [[{'act': 2, 'slot': 'song_name', 'values': ['Carnivore']}, {'act': 2, 'slot': 'playback_device', 'values': ['TV']}], [{'act': 2, 'slot': 'therapist_name', 'values': ['Lola vildavskaia']}, {'act': 2, 'slot': 'appointment_time', 'values': ['9:30 am']}, {'act': 2, 'slot': 'appointment_date', 'values': ['march 11th']}], [{'act': 11, 'slot': 'restaurant_name', 'values': ['Precita Park Cafe & Grill']}, {'act': 11, 'slot': 'location', 'values': ['San Francisco']}], [{'act': 11, 'slot': 'song_name', 'values': ['Girl Like you']}, {'act': 11, 'slot': 'artist', 'values': ['Jason Aldean']}, {'act': 11, 'slot': 'album', 'values': ['Rearview town']}, {'act': 5, 'slot': 'count', 'values': ['10']}], [{'act': 12, 'slot': 'intent', 'values': ['ReserveRestaurant']}], [{'act': 11, 'slot': 'event_name', 'values': ['Blueface']}, {'act': 11, 'slot': 'event_location', 'values': ['The Fillmore Philadelphia']}, {'act': 11, 'slot': 'date', 'values': ['March 13th']}, {'act': 11, 'slot': 'time', 'values': ['6 pm']}, {'act': 5, 'slot': 'count', 'values': ['10']}], [{'act': 13, 'slot': 'shared_ride', 'values': []}], [{'act': 4, 'slot': 'humidity', 'values': ['47']}], [{'act': 3, 'slot': '', 'values': []}], [{'act': 11, 'slot': 'airlines', 'values': ['American Airlines']}, {'act': 11, 'slot': 'outbound_departure_time', 'values': ['11:10 am']}, {'act': 11, 'slot': 'inbound_departure_time', 'values': ['7:55 pm']}, {'act': 11, 'slot': 'price', 'values': ['$244']}, {'act': 5, 'slot': 'count', 'values': ['4']}], [{'act': 15, 'slot': '', 'values': []}], [{'act': 11, 'slot': 'hotel_name', 'values': ['AC Hotel By Marriott Beverly Hills']}, {'act': 11, 'slot': 'star_rating', 'values': ['1']}], [{'act': 3, 'slot': '', 'values': []}], [{'act': 12, 'slot': 'intent', 'values': ['ReserveCar']}], [{'act': 4, 'slot': 'price_range', 'values': ['moderate']}], [{'act': 3, 'slot': '', 'values': []}], [{'act': 13, 'slot': 'return_date', 'values': []}, {'act': 13, 'slot': 'origin_city', 'values': []}], [{'act': 2, 'slot': 'account_type', 'values': ['checking']}, {'act': 2, 'slot': 'transfer_amount', 'values': ['$1600']}, {'act': 2, 'slot': 'recipient_name', 'values': ['philip']}, {'act': 2, 'slot': 'recipient_account_type', 'values': ['checking']}], [{'act': 13, 'slot': 'city', 'values': []}], [{'act': 11, 'slot': 'hotel_name', 'values': ['Aloft Phoenix-Airport']}, {'act': 11, 'slot': 'star_rating', 'values': ['3']}, {'act': 5, 'slot': 'count', 'values': ['10']}]], 'context': [['I need a movie to watch.', 'I have 10 movies. What about Searching for Sugar M
Map: 100%|█████████████████████████████| 10000/10000 [00:02<00:00, 4538.33 examples/s]
Map: 100%|█████████████████████████████| 10000/10000 [00:02<00:00, 4676.76 examples/s]
Map: 100%|█████████████████████████████| 10000/10000 [00:02<00:00, 3875.63 examples/s]
Saving the dataset (1/1 shards): 100%|█| 10000/10000 [00:00<00:00, 73679.03 examples/s
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/root/SGD_NLG/tests/lib/python3.10/site-packages/transformers/optimization.py:591: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(

  | Name  | Type       | Params | Mode
---------------------------------------------
0 | model | PT_T5Model | 68.2 M | train
---------------------------------------------
7.7 M     Trainable params
60.5 M    Non-trainable params
68.2 M    Total params
272.806   Total estimated model params size (MB)
18        Modules in train mode
277       Modules in eval mode
Epoch 0:   2%|   | 429/20623 [03:56<3:05:46,  1.81it/s, v_num=_pos, train_loss=0.0826]
/root/SGD_NLG/tests/lib/python3.10/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
/root/SGD_NLG/tests/lib/python3.10/site-packages/transformers/modeling_utils.py:1080: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(

Detected KeyboardInterrupt, attempting graceful shutdown ...
